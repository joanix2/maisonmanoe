{% extends "base.html" %} {% block title %}Mon profil - Maison Manoé{% endblock %} {% block description %}Espace profil utilisateur — informations personnelles, adresses et commandes.{% endblock %} {%
block extra_head %}
<style>
  .profile-section {
    display: none;
  }
  .profile-section.active {
    display: block;
  }
  .nav-item.active {
    background-color: #d3c2a1;
    font-weight: 600;
  }
</style>
{% endblock %} {% block content %}
<section class="py-12 px-4 md:px-8 lg:px-16 bg-gray-50 min-h-screen">
  <div class="container mx-auto max-w-5xl">
    <div class="bg-white rounded-lg shadow p-6">
      <div class="flex flex-col md:flex-row gap-6">
        <!-- Sidebar profil -->
        <aside class="w-full md:w-1/3 flex flex-col items-center text-center md:text-left">
          <div class="w-32 h-32 rounded-full overflow-hidden bg-gray-100">
            <!-- avatar placeholder -->
            <img src="https://picsum.photos/200" alt="Avatar" class="w-full h-full object-cover" />
          </div>
          <h2 class="mt-4 text-xl font-semibold">Marie Dupont</h2>
          <p class="text-sm text-gray-500">marie.dupont@example.com</p>

          <nav class="mt-6 w-full" id="profile-nav">
            <ul class="space-y-2 text-left">
              <li><button data-section="informations" class="nav-item active w-full text-left px-3 py-2 rounded hover:bg-gray-100 transition-colors">Informations</button></li>
              <li><button data-section="adresses" class="nav-item w-full text-left px-3 py-2 rounded hover:bg-gray-100 transition-colors">Adresses</button></li>
              <li><button data-section="commandes" class="nav-item w-full text-left px-3 py-2 rounded hover:bg-gray-100 transition-colors">Commandes</button></li>
              <li><button data-section="favoris" class="nav-item w-full text-left px-3 py-2 rounded hover:bg-gray-100 transition-colors">Favoris</button></li>
              <li><button data-section="securite" class="nav-item w-full text-left px-3 py-2 rounded hover:bg-gray-100 transition-colors">Sécurité</button></li>
            </ul>
          </nav>
        </aside>

        <!-- Contenu principal -->
        <main class="w-full md:w-2/3" id="profile-content">
          <!-- Informations -->
          <section id="informations" class="profile-section active mb-6">
            <div class="flex items-center justify-between">
              <h3 class="text-lg font-semibold">Informations personnelles</h3>
              <a href="#" class="text-sm text-maison-beige hover:underline">Modifier</a>
            </div>
            <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label class="text-sm text-gray-600">Prénom</label>
                <p class="mt-1 font-medium">Marie</p>
              </div>
              <div>
                <label class="text-sm text-gray-600">Nom</label>
                <p class="mt-1 font-medium">Dupont</p>
              </div>
              <div>
                <label class="text-sm text-gray-600">Email</label>
                <p class="mt-1 font-medium">marie.dupont@example.com</p>
              </div>
              <div>
                <label class="text-sm text-gray-600">Téléphone</label>
                <p class="mt-1 font-medium">+33 6 12 34 56 78</p>
              </div>
            </div>
          </section>

          <!-- Adresses -->
          <section id="adresses" class="profile-section mb-6">
            <div class="flex items-center justify-between">
              <h3 class="text-lg font-semibold">Adresses</h3>
              <a href="#" class="text-sm text-maison-beige hover:underline">Ajouter une adresse</a>
            </div>
            <div class="mt-4 grid grid-cols-1 gap-4">
              <div class="border rounded p-4">
                <p class="font-medium">Maison — 12 rue des Fleurs</p>
                <p class="text-sm text-gray-600">75001 Paris, France</p>
                <p class="text-sm text-gray-600">+33 6 12 34 56 78</p>
              </div>
            </div>
          </section>

          <!-- Commandes -->
          <section id="commandes" class="profile-section mb-6">
            <div class="flex items-center justify-between">
              <h3 class="text-lg font-semibold">Commandes récentes</h3>
              <a href="#" class="text-sm text-maison-beige hover:underline">Voir l'historique</a>
            </div>
            <div class="mt-4 space-y-4">
              <div class="border rounded p-4 flex items-center justify-between">
                <div>
                  <p class="font-medium">Commande #2025-001</p>
                  <p class="text-sm text-gray-600">Expédiée le 12/11/2025 — €89.99</p>
                </div>
                <a href="#" class="text-sm text-maison-beige hover:underline">Détails</a>
              </div>
            </div>
          </section>

          <!-- Favoris -->
          <section id="favoris" class="profile-section mb-6">
            <div class="flex items-center justify-between">
              <h3 class="text-lg font-semibold">Mes favoris</h3>
              <a href="/favoris" class="text-sm text-maison-beige hover:underline">Voir tous</a>
            </div>
            <div class="mt-4 text-gray-600">
              <p>8 produits dans votre liste de favoris</p>
            </div>
          </section>

          <!-- Sécurité -->
          <section id="securite" class="profile-section mb-6">
            <div class="flex items-center justify-between">
              <h3 class="text-lg font-semibold">Sécurité</h3>
              <a href="#" class="text-sm text-maison-beige hover:underline">Changer le mot de passe</a>
            </div>
            <p class="mt-3 text-sm text-gray-600">Dernière connexion : 02/12/2025</p>
          </section>
        </main>
      </div>
    </div>
  </div>
</section>

<script>
  // State Machine pour la navigation du profil
  class ProfileStateMachine {
    constructor() {
      this.currentState = "informations";
      this.states = ["informations", "adresses", "commandes", "favoris", "securite"];
      this.init();
    }

    init() {
      // Récupérer tous les boutons de navigation
      const navButtons = document.querySelectorAll(".nav-item");

      navButtons.forEach((button) => {
        button.addEventListener("click", (e) => {
          const targetSection = e.target.dataset.section;
          this.transition(targetSection);
        });
      });
    }

    transition(newState) {
      // Vérifier que le nouvel état est valide
      if (!this.states.includes(newState)) {
        console.error(`État invalide: ${newState}`);
        return;
      }

      // Si on est déjà dans cet état, ne rien faire
      if (this.currentState === newState) {
        return;
      }

      // Transition: sortir de l'ancien état
      this.exitState(this.currentState);

      // Mettre à jour l'état actuel
      this.currentState = newState;

      // Transition: entrer dans le nouvel état
      this.enterState(newState);
    }

    exitState(state) {
      // Retirer la classe active de la section
      const section = document.getElementById(state);
      if (section) {
        section.classList.remove("active");
      }

      // Retirer la classe active du bouton de navigation
      const navButton = document.querySelector(`[data-section="${state}"]`);
      if (navButton) {
        navButton.classList.remove("active");
      }
    }

    enterState(state) {
      // Ajouter la classe active à la section
      const section = document.getElementById(state);
      if (section) {
        section.classList.add("active");
      }

      // Ajouter la classe active au bouton de navigation
      const navButton = document.querySelector(`[data-section="${state}"]`);
      if (navButton) {
        navButton.classList.add("active");
      }

      // Optionnel: sauvegarder l'état dans l'URL sans scroll
      history.replaceState(null, "", `#${state}`);
    }

    // Méthode pour obtenir l'état actuel
    getState() {
      return this.currentState;
    }
  }

  // Initialiser la state machine au chargement de la page
  document.addEventListener("DOMContentLoaded", () => {
    const profileSM = new ProfileStateMachine();

    // Si un hash est présent dans l'URL, naviguer vers cette section
    const hash = window.location.hash.slice(1);
    if (hash && profileSM.states.includes(hash)) {
      profileSM.transition(hash);
    }
  });
</script>
{% endblock %}
